-- Kenon Hub - Auto Farm Bone & Moon Phase Tracker
-- Script created by khoitongdz for Blox Fruits

-- Kiểm tra Executor hỗ trợ
local function IsSupportedExecutor()
    local success, executor = pcall(function() return identifyexecutor() end)
    if not (success and executor) then
        warn("Executor không được hỗ trợ! Script có thể không hoạt động chính xác.")
    end
end
IsSupportedExecutor()

-- Các biến chính
local AutoFarmBoneEnabled = false
local MoonPhase = "No Moon"
local MoonPercentage = 0

-- GUI Setup bằng Fluent
local Fluent = loadstring(game:HttpGet("https://raw.githubusercontent.com/khoitongdz/ui/refs/heads/main/.gitignore"))()
local Window = Fluent:CreateWindow({
    Title = "Kenon Hub",
    SubTitle = "Blox Fruits",
    TabWidth = 110,
    Size = UDim2.fromOffset(480, 320),
    Acrylic = false,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.End
})

local MainTab = Window:AddTab("Main")
local FarmButton = MainTab:AddToggle("Auto Farm Bone", false, function(state)
    AutoFarmBoneEnabled = state
end)
local MoonLabel = MainTab:AddLabel("Moon Phase: " .. MoonPhase .. " (" .. MoonPercentage .. "%)")

-- Hàm cập nhật trạng thái Moon Phase
local function UpdateMoonPhase()
    local hour = tonumber(game.Lighting.TimeOfDay:sub(1, 2))
    local cyclePosition = (hour % 24) / 24
    MoonPercentage = math.floor(cyclePosition * 100)
    if cyclePosition >= 0.75 or cyclePosition < 0.25 then
        MoonPhase = "Full Moon"
    elseif cyclePosition >= 0.25 and cyclePosition < 0.5 then
        MoonPhase = "Waning Moon"
    elseif cyclePosition >= 0.5 and cyclePosition < 0.75 then
        MoonPhase = "Waxing Moon"
    else
        MoonPhase = "No Moon"
    end
    MoonLabel:SetText("Moon Phase: " .. MoonPhase .. " (" .. MoonPercentage .. "%)")
end

-- Hàm Auto Farm Bone
local function AutoFarmBone()
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()

    while AutoFarmBoneEnabled do
        local hauntedCastle = game.Workspace:FindFirstChild("Haunted Castle")
        if hauntedCastle then
            character.HumanoidRootPart.CFrame = hauntedCastle.CFrame
            wait(2)

            for _, mob in ipairs(hauntedCastle:GetChildren()) do
                if mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    character.HumanoidRootPart.CFrame = mob.HumanoidRootPart.CFrame
                    wait(0.3)
                    mob.Humanoid:TakeDamage(50)
                end
            end
        else
            warn("Không tìm thấy Haunted Castle!")
        end
        wait(1)
    end
end

-- Kết nối toggle Auto Farm
FarmButton.OnChanged:Connect(function()
    if AutoFarmBoneEnabled then
        spawn(AutoFarmBone)
    end
end)

-- Cập nhật Moon Phase theo thời gian thực
game:GetService("RunService").Heartbeat:Connect(UpdateMoonPhase)
